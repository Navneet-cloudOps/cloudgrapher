!function e(t,n,a){function r(s,i){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!i&&u)return u(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[s]={exports:{}};t[s][0].call(d.exports,function(e){var n=t[s][1][e];return r(n?n:e)},d,d.exports,e,t,n,a)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<a.length;s++)r(a[s]);return r}({1:[function(e,t,n){var a=e("./findedges").findEdges;n.graphOptions={nodes:{brokenImage:"images/unknown.png"},edges:{style:"arrow","color.highlight":"red"},stabilize:!0,zoomExtentOnStabilize:!0},n.collectData=function(e){"use strict";var t={nodes:[],edges:[]},n=[],r=[],o=function(e,t){r.push({from:s,to:e,title:t})};for(var s in e.Resources){var i=e.Resources[s],u=i.Properties,c=i.Type.toLowerCase().replace(/::/g,"-");n.push(s),t.nodes.push({id:s,label:s,group:c,shape:"image",image:"images/"+c+".png"}),a(u,o)}return t.edges=r.filter(function(e){return e&&n.indexOf(e.to)>=0}),t},n.collectCyData=function(e){"use strict";var t={"AWS::EC2::SecurityGroupIngress":function(e){if("GroupId"===e.data.resource);else if("SourceSecurityGroupId"===e.data.resource){var t=e.data.source;e.data.source=e.data.target,e.data.target=t}return!0},"AWS::EC2::SecurityGroupEgress":function(e){if("DestinationSecurityGroupId"===e.data.resource);else if("GroupId"===e.data.resource){var t=e.data.source;e.data.source=e.data.target,e.data.target=t}return!0},"default":function(e,t,n){return n&&"AWS::EC2::SecurityGroup"===n.type?(s[e.data.source].data.parent=e.data.target,!1):!0},get:function(e){return this[e]||this["default"]}},n={nodes:[],edges:[]},r=0,o=function(e,t,n){i.push({data:{id:"e"+r++,source:u,target:e,title:t,resource:n}})},s={},i=[];for(var u in e.Resources){var c=e.Resources[u],d={data:{id:u},classes:c.Type.toLowerCase().replace(/::/g,"-"),type:c.Type};a(c.Properties,o),s[u]=d,n.nodes.push(d)}return n.edges=i.filter(function(e){var n=s[e.data.source],a=s[e.data.target],r=t.get(n.type);return e&&n&&a&&r(e,n,a)}),n}},{"./findedges":3}],2:[function(e,t,n){!function(){"use strict";var t,n,a,r=e("./collectdata"),o=$.ajax({url:"styles/main.cycss",type:"GET",dataType:"text"});t=ace.edit("jsoneditor"),t.setTheme("ace/theme/tomorrow_night_eighties"),t.getSession().setMode("ace/mode/json"),t.setOption("maxLines",60),t.setOption("minLines",40),t.getSession().on("changeAnnotation",function(){var e=t.getSession().getAnnotations();if($("#statusbar").toggleClass("failure",0!==e.length),0===e.length){var n=t.getSession().getLength()<2&&0===t.getSession().getLine(0).length?"No content":"Valid";$("div.status-message").text(n)}else{var a=e[0];$("div.status-message").text(a.text+" at "+a.row+":"+a.column)}});var s=ace.require("ace/ext/statusbar").StatusBar;new s(t,document.getElementById("statusbar")),t.commands.addCommand({name:"showKeyboardShortcuts",bindKey:{win:"Ctrl-Alt-h",mac:"Command-Alt-h"},exec:function(e){ace.config.loadModule("ace/ext/keybinding_menu",function(t){t.init(e),e.showKeyboardShortcuts()})}});var i=function(e){var n=new FileReader;n.onload=function(){var e=n.result;e&&(t.setValue(e),t.navigateTo(0,0)),t.resize()},n.readAsText(e)},u=function(){var e;try{e=r.collectCyData(JSON.parse(t.getValue()))}catch(s){e={}}console.log(e),a||(a=$("div.graph_overlay")),n=cytoscape({container:document.getElementById("graph_area"),elements:e,style:o,layout:{name:"cose",padding:5}}),a.fadeIn(300)},c=function(){var e="template";try{e=JSON.parse(t.getValue(t.getValue())).Description}catch(n){}return e},d=function(){var e=window.open("/savegraph.html");e.onload=function(){e.document.getElementById("graphPNG").src=n.png()}},f=function(){var e=JSON.stringify(JSON.parse(t.getValue()),null,2),n=new Blob([e],{type:"text/plain;charset=utf-8"});saveAs(n,c()+".json")},l=document.getElementById("cfeditor");l.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),l.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),i(e.dataTransfer.files[0])},!1),$("#open_template").change(function(e){i(e.target.files[0])}),$("#save_template").click(function(e){return e.preventDefault(),f(),!1}),$("#save_graph").click(function(e){return e.preventDefault(),d(),!1}),$("#show_graph").click(function(e){return e.preventDefault(),u(),!1}),$("#close_graph").click(function(e){return e.preventDefault(),a.fadeOut(500),!1}),$("#graph_layout").change(function(){n.layout({name:$("#graph_layout").val()})})}()},{"./collectdata":1}],3:[function(e,t,n){n.findEdges=function a(e,t,n){"use strict";if(e instanceof Array)e.forEach(function(e){a(e,t,n||"")});else if("object"==typeof e)if(1===Object.keys(e).length){var r=Object.keys(e)[0];if("Ref"===r&&"string"==typeof e[r])t(e[r],n||"",n);else if("Fn::Join"===r&&e[r]instanceof Array)e[r][1].forEach(function(n){a(n,t,e[r][1].join(e[r][0]))});else if("Fn::GetAtt"===r&&e[r]instanceof Array)t(e[r][0],e[r][1],n);else for(var o in e)a(e[o],t,o)}else for(var s in e)a(e[s],t,s)}},{}]},{},[2]);
//# sourceMappingURL=edit.bundle.js.map